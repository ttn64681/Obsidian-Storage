# Relational Databases and Object-Relational Mapping
- **DBMD** Database Management System
	- a software system that supports creation, population, querying, and administering of a database
- **DDL** Data Definition Language for defining database structure
	- create a table, create indexes, alter table, etc.
- **DML** Data Manipulation Language for retrieving and updating data
	- select rows from 1 or more tables (using joins), insert, update, or delete rows

## Relational Database
- Consists of number of tables and single schema (def of tables and their attributes)

Tables consists of:
- Table
- Columns
- Rows (tuples)

## Primary Key
- *The minimal subset of fields* that UNIQUELY IDENTIFIES a tuple
	- student_id
	- course_id
		- no two id's that are the same

- if there are MORE THAN 1 KEY that UNIQUELY IDENTIFIES a tuple, then that is a:
	- ***Composite Key***

| fid | date   | seat | fname | lname |
| --- | ------ | ---- | ----- | ----- |
| 734 | 4/5/11 | A4   |       |       |
| 734 | 5/9/11 | F7   |       |       |
- fid, date, seat -> **composite key**

- sometimes another unique, non-redundant identifier exists, called:
	- **Candidate Key**
		- login


## Foreign Key - Table Relationships
- Ex: Course offered by Department

| cid | instr | sem | deptid |
| --- | ----- | --- | ------ |
|     |       |     |        |

| did | name | college |
| --- | ---- | ------- |
|     |      |         |
![[Drawing 2025-10-06 07.38.24.excalidraw]]

## 1-1 and 1-m associations (FK on many)
- are mapped onto foreign keys
- 1-1, 1-optional, and 1-m associations!
- Only one table should have the foreign key defined
	- for 1-m, it should be the table on the "many" side

## Many-to-many relationships (FK to both tables)
- In general, we need new table Enrolls(crsid, studid)
	- crsid is a foreign key that references cid in Course table
	- studid is a foriegn key that references sid in Student table

- whenever you have m-m relationship, you generally have a 3rd table
	- why? instead of having student table w/ multiple rows for student to represent them taking multiple courses, just have another table that defines that many-to-many relationship

**Course:**

| cid | instr | sem | deptid |
| --- | ----- | --- | ------ |
|     |       |     |        |

**Enrolls:**

| crsid (reference cid) | studid (reference sid) | grade |
| --------------------- | ---------------------- | ----- |
|                       |                        |       |
- if you wanted to add grade, add to this table since its a relationship between Student and Course

**Student:**

| did | name | college |
| --- | ---- | ------- |
|     |      |         |

## Mapping of Generalization
- Inheritance relationship
- Method 1 :
	- Parent and Child classes are mapped onto own tables
	- **Child class table has FK to Parent table**
		- Child class object is represented partially in Child table (Child class attributes) 
		- and partially in Parent class (Parent class attributes)
	- retrieval of complete Child class object requires a join SQL statement
		- foreign key connects the two parts
# Relational Algebra (Statements)
- Created by Codd
- Collection of operators for specifying queries
- query describes step-by-step procedure for computing answer
## Basic operators
- **Selection**
	- return *rows* that meet some condition
- **Projection**
	- return *column* values
- Union
- Cross product
- Difference
- Other operations can be defined in terms of basic operators

**Example Schema**
- Course (<u>cid</u>, instructor, quarter, dept)
- Student (<u>sid</u>, name, gpa)
- Enrolls (cid, grade, stuid)

### Operators
- Sigma - Selection Operator
	- σ
- Pi - Projection Operator
	- Π

## Selection - σ
- σ_(gpa>3.3) (S1)
	- Select students w/ gpa higher than 3.3 from S1 table (Student 1)

## Projection - Π
- Π_(name, gpa) (S1)
	- Select all names and gpa of all students in S1 table (Student 1)

## Combine Selection and Projection
- Π_(name, gpa) [ σ_(gpa>3,3) (S1) ]
	- Select name and gpa of all Students who have gpa > 3.3

## Joins - ⋈
- Combine info from 2 or more tables
- Ex: courses owned by departments
	- **C1** *⋈* \_(C1.deptid = D.did) **D**
		- **Join C1 and D table columns for a specific shared Department Id**


<hr>

# SQL
- **DDL** Data Definition Language for defining database structure
	- create a table, create indexes, alter table, etc.
- **DML** Data Manipulation Language for retrieving and updating data
	- select rows from 1 or more tables (using joins), insert, update, or delete rows

- CREAT TABLE
- ALTER TABLE, DROP TABLE
- CREATE INDEX, DROP INDEX
	- improves the performance of data retrieval operations (SELECT)
	- **Indexes are special lookup tables that database search engine can use to speedup data retrieval**
	- *Use on columns frequently queried, used in WHERE clauses, JOIN conditions, ORDER BY clauses, or for unique constraints*
- SELECT-FROM-WHERE
	- WHERE clause is optional
- INSERT
- UPDATE
- DELETE

# Relational DBMS
- Examples of commercial RDBMS systems:
	- ORACLE
	- DB2 (IBM)
	- SQL Server (Microsoft)
- Examples of open source RDBMS systems:
	- MySQL
	- PostgreSQL
	- MSQL

- **Client program can be in any lang, but must "speak" the RDBMS communication lang, usually over network**
	- Java or C++ client
- **Communication lang/protocol or an API**
	- Communication layer could be JDBC if Java, or ODBC is C++
- **RDBMS server, which accepts request over network**
	- RDBMS w/ JDBC or ODBC drivers

# Object Persistence
- **Classes are mapped onto tables**

- preserve attribute names and select suitable types from SQL
- define column that serves as a primary key (automatically generated)
- set constraints, unique, enum-like vals
- operations are not represented

- **Objects are represented as rows**
- Beware of dates

## Deliverable 4
![[Drawing 2025-09-25 10.43.43.excalidraw]]

## Composite Key
- multiple column fields that uniquely identify (are all different vals) an entity
![[Drawing 2025-09-30 09.42.46.excalidraw]]











### Commands
Sigma_x>#
- retrieve all where condition (x > #)
Pi_x,y
- retrieve columns x and y
### Joins
- Combine information from two or more tables
- Example:

## Create Table
- every tables maps to a class
	- ex: Springboot

```
CREATE TABLE Club (
	Id INT UNSIGNED PRIMARY KEY,
	Name VARCHAR(255) NOT NULL,
	Address VARCHAR(255),
	Established DATETIME
);

CREATE TABLE IsMemberOf (
	Id INT UNSIGNED PRIMARY KEY,
	Name VARCHAR(255) ...
);

```

### Select-From-Where query
"Find all clubs"
- SELECT * FROM Club
"Find all names of all persons under 18"
* SELECT p.FirstName
* FROM p.Member
* WHERE 


## Object Persistence
- Classes are mapped onto tables


## m-m relationships
- One to Many
	- Primary key on One side is Foreign key on Many side
	- Ex: What i have in Springboot

- Many to Many
	- create third table
	- twwo foreign keys for each table
	- 

Employee table
- primary key

Skills table
- primary key
- include foreign key to employee

Employee Skills (Composite key[empId, skillId])
- Many skills have many employees
- many employees have many skills

| id [PK] | empId [FK] | skillId [FK] |
| ------- | ---------- | ------------ |
|         |            |              |

## generalization mapping (inheritance)
![[Drawing 2025-09-30 10.12.11.excalidraw]]


| id  | Type_id [FK references id in table UserTypes] | name | email | password | address           |
| --- | --------------------------------------------- | ---- | ----- | -------- | ----------------- |
| 1   | 1                                             |      |       |          | NULL              |
| 2   | 2                                             |      |       |          | "123 main street" |

**User Types**

| id  | Type     |
| --- | -------- |
| 1   | admin    |
| 2   | customer |

**Map to one table**
- retrieve all admins
```MySQL
SELECT * from Users 
WHERE typeid=1
```
```PostgreSQL
SELECT u from Users u
WHERE type_id=1

```

## Normalization
- Database Normalization **reduces redundancy** which make tables/*database smaller* and *querying faster*

## B-trees used w/in databases
- B-trees are a fundamental data structure in computer science, specifically designed for efficient storage and retrieval of data on disk. Their relationship with databases, particularly PostgreSQL, is central to how these systems achieve high performance.

### Relationship to Databases (PostgreSQL):
- **Indexing:**
    B-trees are the default and most commonly used index type in PostgreSQL. When you create an index on a column or set of columns in a table, PostgreSQL typically implements this index using a B-tree structure.
- **Efficient Data Retrieval:**
    B-trees are optimized for disk I/O, which is crucial for databases where data often resides on slower storage devices. Their balanced, multi-way tree structure minimizes the number of disk reads required to locate specific data records, offering logarithmic time complexity for search, insertion, and deletion operations.

<hr>

## Deliverable 5
- **Include Primary Key**
	- underline it or write [PK]
- Foreign Keys reference


## QUIZ
- uga members borrow books
- each member can borrow multiple books, and each book can be borrowed by multiple members

for every borrowing event, the borrow date and return date must be recorded
it is possible for the same member to borrow the same book multiple times (on different dates),
but a member should not borrow the same book more than once on the same date

We have 2 classes in class diagram: Book and Borrower w/ a many-to-many relationship. 
class book has attributes, serial number, ISBN, title, and author. Class borrower has the attributes UGA_ID and name.

Putting constraints in database makes querying faster, less querying with specifics conditionals

member:
- id [PK] : Primary Key
- UGA_ID : INT
- name : String

book:
- id [PK] : Primary Key
- serial: INT
- ISBN: String
- title : String
- author: String
- borrowed : boolean

Member_Book:
- id [PK] : Primary Key
- member_id [FK] : Foreign Key
- book_id [FK] : Foreign Key
- borrow_date : Date
- return_date : date


- [ ] Object Relational Mapping Quiz 3
- what is orm?
- given (activity 6), insert table or listing attributes clearly
- many-to-many: have a separate 

